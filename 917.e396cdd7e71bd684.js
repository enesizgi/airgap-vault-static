"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[917],{42723:(w,A,o)=>{o.d(A,{K:()=>E});var a=o(20976),l=o(12714),d=o(84653),i=o(3323),M=o(34388),m=o(9527),p=o(51628),O=o(9288);let E=(()=>{class v{}return v.\u0275fac=function(f){return new(f||v)},v.\u0275mod=O.oAB({type:v}),v.\u0275inj=O.cJS({imports:[[i.Pc,p.D,l.ez,d.u5,M.aw,m.N,a.aD]]}),v})()},5469:(w,A,o)=>{o.d(A,{J:()=>F,B:()=>C});var a=o(65949),l=o(20976),d=o(88061),i=o(3323),M=o(63181),m=o(16183),p=o(55956),O=o(98691),E=o(13187),v=o(27204),T=o(64545),f=o(2853),Z=o(39141),n=o(56810),e=o(9288),_=o(34388),c=o(12714);function g(r,h){if(1&r){const t=e.EpF();e.TgZ(0,"ion-item",1),e.NdJ("click",function(){return e.CHM(t),e.oxw().openAddressExplorer()}),e._UZ(1,"ion-icon",5),e._uU(2," Address Explorer "),e.qZA()}}let P=(()=>{class r{constructor(t,s,u,y,b,I){this.alertCtrl=t,this.clipboardService=s,this.secretsService=u,this.popoverController=y,this.translateService=b,this.navigationService=I}ngOnInit(){return(0,a.mG)(this,void 0,void 0,function*(){this.protocolIdentifier=yield this.wallet.protocol.getIdentifier()})}copyAddressToClipboard(){return(0,a.mG)(this,void 0,void 0,function*(){yield this.clipboardService.copyAndShowToast(this.wallet.receivingPublicAddress,this.translateService.instant("wallet-edit-delete-popover.confirm_address_copy")),yield this.popoverController.dismiss()})}copyShareUrlToClipboard(){return(0,a.mG)(this,void 0,void 0,function*(){yield this.clipboardService.copyAndShowToast(yield this.getWalletShareUrl(),this.translateService.instant("wallet-edit-delete-popover.confirm_sync_code_copy")),yield this.popoverController.dismiss()})}showAddressQR(){return(0,a.mG)(this,void 0,void 0,function*(){this.openAddressQR(),yield this.popoverController.dismiss()})}openAddressExplorer(){return(0,a.mG)(this,void 0,void 0,function*(){this.navigationService.routeWithState("/address-explorer",{wallet:this.wallet}),yield this.popoverController.dismiss()})}delete(){this.translateService.get(["wallet-edit-delete-popover.account-removal_alert.title","wallet-edit-delete-popover.account-removal_alert.text","wallet-edit-delete-popover.account-removal_alert.cancel_label","wallet-edit-delete-popover.account-removal_alert.delete_label"]).pipe((0,Z.P)()).subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){const s=t["wallet-edit-delete-popover.account-removal_alert.title"],u=t["wallet-edit-delete-popover.account-removal_alert.text"],y=t["wallet-edit-delete-popover.account-removal_alert.cancel_label"],b=t["wallet-edit-delete-popover.account-removal_alert.delete_label"];(yield this.alertCtrl.create({header:s,message:u,buttons:[{text:y,role:"cancel",handler:()=>{this.popoverController.dismiss().catch((0,p.a1)(p.qj.IONIC_ALERT))}},{text:b,handler:()=>{this.secretsService.removeWallet(this.wallet).then(()=>{this.popoverController.dismiss().catch((0,p.a1)(p.qj.IONIC_ALERT)),this.onDelete&&this.onDelete()}).catch((0,p.a1)(p.qj.SECURE_STORAGE))}}]})).present().catch((0,p.a1)(p.qj.IONIC_ALERT))}))}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(i.Br),e.Y36(l.Yv),e.Y36(n.R),e.Y36(i.Dh),e.Y36(_.sK),e.Y36(v.f))},r.\u0275cmp=e.Xpm({type:r,selectors:[["airgap-account-edit-popover"]],decls:22,vars:16,consts:[["lines","none",1,"ion-no-padding","ion-no-margin"],["button","","detail","false",3,"click"],["name","clipboard-outline","color","dark","slot","end"],["name","trash","color","dark","slot","end"],["button","","detail","false",3,"click",4,"ngIf"],["name","list","color","dark","slot","end"]],template:function(t,s){1&t&&(e.TgZ(0,"ion-list",0)(1,"ion-list-header")(2,"ion-label"),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"ion-item",1),e.NdJ("click",function(){return s.copyAddressToClipboard()}),e._UZ(6,"ion-icon",2),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"ion-item",1),e.NdJ("click",function(){return s.copyShareUrlToClipboard()}),e._UZ(10,"ion-icon",2),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"ion-item",1),e.NdJ("click",function(){return s.showAddressQR()}),e._UZ(14,"ion-icon",2),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"ion-item",1),e.NdJ("click",function(){return s.delete()}),e._UZ(18,"ion-icon",3),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.YNc(21,g,3,0,"ion-item",4),e.qZA()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,6,"wallet-edit-delete-popover.settings_label")),e.xp6(4),e.hij(" ",e.lcZ(8,8,"wallet-edit-delete-popover.copy_label")," "),e.xp6(4),e.hij(" ",e.lcZ(12,10,"wallet-edit-delete-popover.copy_sync_code")," "),e.xp6(4),e.hij(" ",e.lcZ(16,12,"wallet-edit-delete-popover.show_address_qr")," "),e.xp6(4),e.hij(" ",e.lcZ(20,14,"wallet-edit-delete-popover.account-removal_alert.delete_label")," "),e.xp6(2),e.Q6J("ngIf",s.wallet&&s.wallet.isExtendedPublicKey&&s.protocolIdentifier&&"grs"!==s.protocolIdentifier))},directives:[i.q_,i.yh,i.Q$,i.Ie,i.gu,c.O5],pipes:[_.X$],styles:[".dismiss[_ngcontent-%COMP%]{text-align:center;font-weight:bolder;color:var(--ion-color-secondary)}"]}),r})();var U=o(23345);function S(r,h){1&r&&(e.TgZ(0,"ion-chip",19),e._uU(1,"HD Wallet"),e.qZA())}function x(r,h){1&r&&(e.TgZ(0,"ion-chip",19),e._uU(1,"BIP39 passphrase"),e.qZA())}function D(r,h){if(1&r&&(e.TgZ(0,"p"),e.YNc(1,S,2,0,"ion-chip",18),e.YNc(2,x,2,0,"ion-chip",18),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.wallet.isExtendedPublicKey),e.xp6(1),e.Q6J("ngIf",t.secret.fingerprint!==t.wallet.masterFingerprint)}}function W(r,h){if(1&r){const t=e.EpF();e.TgZ(0,"ion-row",20)(1,"ion-col",21)(2,"ion-button",22),e.NdJ("click",function(){const y=e.CHM(t).$implicit;return e.oxw(2).share(y)}),e._UZ(3,"img",23),e._uU(4),e.qZA()()()}if(2&r){const t=h.$implicit;e.xp6(3),e.MGl("src","assets/logos/",t.icon,"",e.LSH),e.xp6(1),e.hij(" \xa0 ",t.name," ")}}function N(r,h){1&r&&(e.ynx(0),e.TgZ(1,"ion-row")(2,"ion-col"),e._uU(3," To use AirGap Vault with MetaMask or Rabby wallet, please migrate this account. To do so, simply remove and re-add this Ethereum account. For help, visit our docs. "),e.qZA()(),e.BQk())}function L(r,h){if(1&r){const t=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Address QR"),e.qZA(),e.TgZ(4,"ion-buttons",24)(5,"ion-button",4),e.NdJ("click",function(){return e.CHM(t),e.oxw(),e.MAs(28).dismiss()}),e._uU(6,"Close"),e.qZA()()()(),e.TgZ(7,"ion-content")(8,"ion-row",25),e._UZ(9,"airgap-qr",26),e.qZA()()}if(2&r){const t=e.oxw(2);e.xp6(9),e.Q6J("qrdata",t.wallet.receivingPublicAddress)("level","L")("size",300)}}function R(r,h){if(1&r){const t=e.EpF();e.TgZ(0,"ion-content",7)(1,"ion-row",7)(2,"ion-col")(3,"ion-avatar"),e._UZ(4,"airgap-identicon",8),e.qZA(),e._UZ(5,"airgap-currency-symbol",9),e.qZA(),e.TgZ(6,"ion-col")(7,"h2",10),e._uU(8),e.qZA(),e.TgZ(9,"p"),e._uU(10),e.ALo(11,"translate"),e._UZ(12,"br"),e.TgZ(13,"span",11),e.NdJ("click",function(){return e.CHM(t),e.oxw().copyAddressToClipboard()}),e._uU(14),e.qZA()(),e.TgZ(15,"p"),e._uU(16),e.ALo(17,"translate"),e._UZ(18,"br"),e.TgZ(19,"span",12),e._uU(20),e.qZA()(),e.YNc(21,D,3,2,"p",13),e.ALo(22,"async"),e.qZA()(),e.TgZ(23,"p",14),e._uU(24,"You can sync this account with:"),e.qZA(),e.YNc(25,W,5,2,"ion-row",15),e.YNc(26,N,4,0,"ng-container",13),e.TgZ(27,"ion-modal",16,17),e.YNc(29,L,10,3,"ng-template"),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(4),e.Q6J("address",t.wallet.receivingPublicAddress),e.xp6(1),e.Q6J("symbol",t.protocolSymbol)("protocolIdentifier",t.protocolIdentifier),e.xp6(3),e.AsE("",t.protocolName," ",t.protocolSymbol,""),e.xp6(2),e.hij(" ",e.lcZ(11,13,"wallet-address.address_label")," "),e.xp6(4),e.Oqu(t.wallet.receivingPublicAddress),e.xp6(2),e.hij(" ",e.lcZ(17,15,"wallet-address.path_label")," "),e.xp6(4),e.Oqu(t.wallet.derivationPath),e.xp6(1),e.Q6J("ngIf",e.lcZ(22,17,t.isAppAdvancedMode$)),e.xp6(4),e.Q6J("ngForOf",t.syncOptions),e.xp6(1),e.Q6J("ngIf",t.showMetaMaskMigrationOnboarding),e.xp6(1),e.Q6J("presentingElement",t.presentingElement)}}const C={icon:"airgap-wallet-app-logo.png",name:"AirGap Wallet",qrType:l.Ie.V3},j={icon:"bluewallet.png",name:"BlueWallet",qrType:l.Ie.BC_UR},G={icon:"sparrowwallet.png",name:"Sparrow Wallet",qrType:l.Ie.BC_UR},B={icon:"specterwallet.png",name:"Specter Wallet",qrType:l.Ie.BC_UR},K={icon:"metamask.webp",name:"MetaMask",qrType:l.Ie.METAMASK},Y={icon:"rabby-wallet.svg",name:"Rabby",qrType:l.Ie.METAMASK};let F=(()=>{class r{constructor(t,s,u,y,b,I,J,k,Q,q){if(this.popoverCtrl=t,this.clipboardService=s,this.shareUrlService=u,this.interactionService=y,this.navigationService=b,this.uiEventService=I,this.migrationService=J,this.deepLinkService=k,this.storageService=Q,this.router=q,this.showMetaMaskMigrationOnboarding=!1,this.isAppAdvancedMode$=this.storageService.subscribe(m.NT.ADVANCED_MODE_TYPE).pipe((0,M.U)(H=>H===m.$r.ADVANCED)),this.presentingElement=null,this.wallet=this.navigationService.getState().wallet,this.secret=this.navigationService.getState().secret,!this.wallet)throw this.router.navigate(["/"]),new Error("[AccountAddressPage]: No wallet found! Navigating to home page.")}ngOnInit(){return(0,a.mG)(this,void 0,void 0,function*(){if(this.presentingElement=document.querySelector(".ion-page"),this.wallet){const[t,s,u]=yield Promise.all([this.wallet.protocol.getSymbol(),this.wallet.protocol.getIdentifier(),this.wallet.protocol.getName()]);switch(this.protocolSymbol=t,this.protocolIdentifier=s,this.protocolName=u,s){case d.MainProtocolSymbols.BTC_SEGWIT:this.syncOptions=[C,j,G,B];break;case d.MainProtocolSymbols.ETH:this.syncOptions=[C],this.wallet.isExtendedPublicKey?this.syncOptions.push(K,Y):this.showMetaMaskMigrationOnboarding=!0;break;default:this.syncOptions=[C]}}})}done(){this.navigationService.routeWithState("/accounts-list",{secret:this.secret}).catch((0,p.a1)(p.qj.IONIC_NAVIGATION))}share(t=C){return(0,a.mG)(this,void 0,void 0,function*(){yield this.waitWalletShareUrl(),this.interactionService.startInteraction({operationType:O.jl.WALLET_SYNC,iacMessage:this.shareObject,companionApp:t})})}presentEditPopover(t){return(0,a.mG)(this,void 0,void 0,function*(){return(yield this.popoverCtrl.create({component:P,componentProps:{wallet:this.wallet,openAddressQR:()=>{this.modal.present().catch((0,p.a1)(p.qj.IONIC_MODAL))},getWalletShareUrl:()=>(0,a.mG)(this,void 0,void 0,function*(){return yield this.waitWalletShareUrl(),this.walletShareUrl}),onDelete:()=>{this.navigationService.back()}},event:t,translucent:!0})).present().catch((0,p.a1)(p.qj.IONIC_ALERT))})}copyAddressToClipboard(){return(0,a.mG)(this,void 0,void 0,function*(){yield this.clipboardService.copyAndShowToast(this.wallet.receivingPublicAddress)})}waitWalletShareUrl(){return(0,a.mG)(this,void 0,void 0,function*(){yield this.prepareSyncObject(),this.walletShareUrl=yield this.deepLinkService.generateDeepLinkUrl(this.shareObject)})}prepareSyncObject(){return(0,a.mG)(this,void 0,void 0,function*(){if(void 0===this.shareObject)return yield this.migrationService.runWalletsMigration([this.wallet]),(0,f.l)(this.wallet)?(void 0===this.shareObjectPromise&&(this.shareObjectPromise=new Promise(t=>(0,a.mG)(this,void 0,void 0,function*(){const s=yield this.shareUrlService.generateShareWalletURL(this.wallet);t(s)})).then(t=>{this.shareObject=t,this.shareObjectPromise=void 0})),this.shareObjectPromise):(yield this.showWalletNotMigratedAlert(),Promise.reject("Cannot create share URL, wallet data is incomplete"))})}showWalletNotMigratedAlert(){return(0,a.mG)(this,void 0,void 0,function*(){return this.uiEventService.showTranslatedAlert({header:"wallet-address.alert.wallet-not-migrated.header",message:"wallet-address.alert.wallet-not-migrated.message",buttons:[{text:"wallet-address.alert.wallet-not-migrated.button_label"}]})})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(i.Dh),e.Y36(l.Yv),e.Y36(T.o),e.Y36(O.k3),e.Y36(v.f),e.Y36(l.Ax),e.Y36(E.H),e.Y36(l._x),e.Y36(m.Cu),e.Y36(U.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["airgap-account-address"]],viewQuery:function(t,s){if(1&t&&e.Gf(i.ki,5),2&t){let u;e.iGM(u=e.CRH())&&(s.modal=u.first)}},decls:11,vars:4,consts:[[1,"ion-no-border"],["slot","start"],["defaultHref","/tabs/tab-secrets"],["slot","primary"],[3,"click"],["slot","icon-only","name","ellipsis-vertical"],["class","ion-padding",4,"ngIf"],[1,"ion-padding"],[3,"address"],[3,"symbol","protocolIdentifier"],[1,"ion-no-margin"],[1,"selectable","typography--mono",3,"click"],[1,"selectable","typography--mono"],[4,"ngIf"],[1,"ion-padding-horizontal","ion-padding-bottom"],["class","ion-padding-bottom",4,"ngFor","ngForOf"],["trigger","open-modal",3,"presentingElement"],["modal",""],["color","light",4,"ngIf"],["color","light"],[1,"ion-padding-bottom"],["size","12"],["expand","block","color","light","shape","round",3,"click"],[2,"width","24px","height","24px",3,"src"],["slot","end"],[1,"ion-justify-content-center","ion-padding-bottom"],[3,"qrdata","level","size"]],template:function(t,s){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"ion-buttons",3)(8,"ion-button",4),e.NdJ("click",function(y){return s.presentEditPopover(y)}),e._UZ(9,"ion-icon",5),e.qZA()()()(),e.YNc(10,R,30,19,"ion-content",6)),2&t&&(e.xp6(5),e.Oqu(e.lcZ(6,2,"wallet-address.title")),e.xp6(5),e.Q6J("ngIf",s.wallet))},directives:[i.Gu,i.sr,i.Sm,i.oU,i.cs,i.wd,i.YG,i.gu,c.O5,i.W2,i.Nd,i.wI,i.BJ,l.bY,l.zZ,i.hM,c.sg,i.ki,l.Sx],pipes:[_.X$,c.Ov],styles:["airgap-currency-symbol[_ngcontent-%COMP%]{position:absolute;height:32px;width:32px;left:40px;top:40px}airgap-identicon[_ngcontent-%COMP%], airgap-identicon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], ion-avatar[_ngcontent-%COMP%]{width:64px;height:64px}ion-modal[_ngcontent-%COMP%]{--ion-background-color: var(--ion-color-secondary);--ion-text-color: var(--ion-color-secondary-contrast)}ion-modal[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: var(--ion-color-secondary)}ion-modal[_ngcontent-%COMP%]   ion-toggle[_ngcontent-%COMP%]{--handle-background: var(--ion-color-secondary-contrast)}ion-modal[_ngcontent-%COMP%]   ion-radio[_ngcontent-%COMP%], ion-modal[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], ion-modal[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%], ion-modal[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--color: var(--ion-color-secondary-contrast)}ion-modal[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%], ion-modal[_ngcontent-%COMP%]   ion-checkbox[_ngcontent-%COMP%]{--border-color: var(--ion-color-secondary-contrast)}"]}),r})()},51628:(w,A,o)=>{o.d(A,{D:()=>l});var a=o(9288);let l=(()=>{class d{}return d.\u0275fac=function(M){return new(M||d)},d.\u0275mod=a.oAB({type:d}),d.\u0275inj=a.cJS({imports:[[]]}),d})()},13187:(w,A,o)=>{o.d(A,{H:()=>T});var a=o(65949),l=o(88061),d=o(90544),i=o(47898),M=o(52971),m=o(2853),p=o(55956),O=o(27204),E=o(56810),v=o(9288);let T=(()=>{class f{constructor(n,e){this.secretsService=n,this.navigationService=e}runSecretsMigration(n){return(0,a.mG)(this,void 0,void 0,function*(){return new Promise((e,_)=>{n.every(m.e)?e():this.navigateToMigrationPage({secrets:n}).then(e).catch(_)})})}runWalletsMigration(n){return(0,a.mG)(this,void 0,void 0,function*(){return new Promise((e,_)=>{n.every(m.l)?e():this.navigateToMigrationPage({wallets:n}).then(e).catch(_)})})}navigateToMigrationPage(n){return(0,a.mG)(this,void 0,void 0,function*(){return new Promise((e,_)=>{this.navigationService.routeWithState("/migration",Object.assign(Object.assign({},n),{onSuccess:e,onError:_})).catch(c=>{(0,p.a1)(p.qj.IONIC_NAVIGATION)(c),_(c)})})})}filterMigratedSecrets(n){return n.every(m.e)?[n,!0]:[n.filter(m.e),!1]}filterMigratedWallets(n){return n.every(m.l)?[n,!0]:[n.filter(m.l),!1]}deepFilterMigratedSecretsAndWallets(n){return(0,a.mG)(this,void 0,void 0,function*(){return n.every(m.e)?[n,!0]:[(yield Promise.all(n.map(_=>(0,a.mG)(this,void 0,void 0,function*(){if(!_.fingerprint)return;const[c]=this.filterMigratedWallets(_.wallets);if(0===c.length)return;const g=M.r.init(_);return g.wallets=c,g})))).filter(_=>void 0!==_),!1]})}migrateSecret(n,e={}){return(0,a.mG)(this,void 0,void 0,function*(){const c=Object.assign(Object.assign({},{persist:!1}),e);if(void 0===n.fingerprint){let g=c.mnemonic;if(void 0===g){const x=yield this.secretsService.retrieveEntropyForSecret(n);g=(0,i.entropyToMnemonic)(x)}const P=yield(0,i.mnemonicToSeed)(g),S=(0,d.fromSeed)(P).fingerprint.toString("hex");n.fingerprint=S}c.persist&&(yield this.secretsService.addOrUpdateSecret(n,{setActive:!1}))})}migrateWallet(n,e){return(0,a.mG)(this,void 0,void 0,function*(){const c=Object.assign(Object.assign({},{bip39Passphrase:"",persist:!1}),e);if(n.masterFingerprint&&!c.persist)return;let P,g=c.mnemonic;if((void 0===g||c.persist)&&(P=this.secretsService.findByPublicKey(n.publicKey)),void 0===g&&void 0!==P){const W=yield this.secretsService.retrieveEntropyForSecret(P);g=(0,i.entropyToMnemonic)(W)}else if(void 0===g)return;if((yield n.protocol.getPublicKeyFromMnemonic(g,n.derivationPath,c.bip39Passphrase))!==n.publicKey)throw new Error("Invalid BIP-39 Passphrase");const S=yield(0,i.mnemonicToSeed)(g,c.bip39Passphrase),D=(0,d.fromSeed)(S).fingerprint.toString("hex");n.masterFingerprint=D,n.status=l.AirGapWalletStatus.ACTIVE,c.persist&&void 0!==P&&(yield this.migrateSecret(P,{mnemonic:c.mnemonic,persist:c.persist}))})}}return f.\u0275fac=function(n){return new(n||f)(v.LFG(E.R),v.LFG(O.f))},f.\u0275prov=v.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()},2853:(w,A,o)=>{function a(d){return d.fingerprint&&d.wallets.every(l)}function l(d){return!!d.masterFingerprint}o.d(A,{e:()=>a,l:()=>l})}}]);